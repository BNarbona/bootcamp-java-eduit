<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <script>
        function apiPokemon() {
            axios.get(`https://pokeapi.co/api/v2/pokemon/ditto`)
            .then(function (response) {
                const msj = {
                    type: 'success',
                    msj: 'Lista obtenida sactifactoriamente'
                };
                 
                Message(msj);
                PokeList(response.data);
        
                /*let sprites = response.data;
                let spriteName = sprites.map(function(s){
                return s;
                });
                console.log(spriteName);*/
       
            })
            .catch(function (error) { 
                const msj = {
                    type: 'danger',
                    msj: error.message
                };
                Message(msj);         
            })
            .then(function () {
                console.log('Mostrando API');
            });
        }
        function Message(message){
            const divError = document.getElementById('divError');
            const alert = ` 
                <div class="alert alert-${message.type} alert-dismissible fade show" role="alert">
                    <strong>${message.msj}</strong>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            divError.innerHTML = alert;
            //console.log(error);
            //divError.style.display ='block';
        }
        
        

        function PokeFilter(data){
            const sprite = data.sprites.other.home;
            let elementoList = [];
            for(let sp in sprite) {
                let elemento = {
                nombre: '',  
                valor: ''    
                };
                if(`${sprite[sp]}`.endsWith('png')||`${sprite[sp]}`.endsWith('svg')){
                    elemento.nombre=`${sp}`;
                    elemento.valor=`${sprite[sp]}`;
                    elementoList.push(elemento);
                }
            }
            return elementoList;
        }
         

        function PokeList(data){
            let listadoFiltrado = PokeFilter(data);
            let divUsers1 = document.getElementById('list1');
            let divUsers2 = document.getElementById('list2');
            let userListTable = `
                <table class="table">
                    <thead>
                        <tr>`
                        for(let elemento of listadoFiltrado){
                        userListTable+=`<th scope="col">${elemento.nombre}</th>`
                        }
                    userListTable+=`</tr>
                    </thead>
                    <tbody>
                       ${Sprite(listadoFiltrado)}
                    </tbody>
                </table>   
                `;
                
            divUsers1.innerHTML = userListTable;
            divUsers2.innerHTML = userListTable;
        }

        function Sprite(listadoFiltrado){
            let spritesRow='';
                spritesRow+=`
                    <tr>`
                        for(let elemento of listadoFiltrado){
                            spritesRow+=`<td>
                                    <img src="${elemento.valor}">
                                </td>`
                        }
                    spritesRow+=`</tr>
                    `;
            return spritesRow;
        }

    </script>

</head> 

<body>
    <main>
        <div class="conteiner">
            <div class="row">
                
                    <div class="col-12">
                      <div id="divError"> </div>  
                    </div>
                    <div class="row">
                        <div class="col-6 mt-5">
                            <button class="btn btn-success" onclick="apiPokemon()">Lista sprites</button> 
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 mt-5">
                            <div id ="list1"> </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 mt-5">
                            <div id ="list2"> </div>
                        </div>
                    </div>
                </div>
                    
            </div>
        </div>
    </main>
</body>

</html>
